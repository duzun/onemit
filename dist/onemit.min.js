(function(A,t,x){function u(b,k){for(var f in k)v.call(k,f)&&(b[f]=k[f]);return b}function B(b,k){for(var f=b.length,p,a=1,e,c=arguments.length,q;a<c;++a)for(q=arguments[a],b.length=e=f+q.length,p=0;f<e;++f,++p)b[f]=q[p];return b}var w=x+"",v={}.hasOwnProperty,r=[].slice,C=[].splice,y=v.bind,D=typeof setTimeout!=w?setTimeout:t.setTimeout,E=typeof setImmediate!=w?setImmediate:t.setImmediate,z=typeof Promise!=w?Promise:t.Promise;("function"===typeof define&&define.amd?define:typeof module!=w&&module.exports?
function(b,k){module.exports=k()}:function(b,k){t[A]=k()})([],function(){function b(a){if(a)return u(a,b.prototype)}function k(a){if(!(this instanceof k))return new k(a);a==x&&(a="");"string"==typeof a&&(a={type:a});u(this,a);this.timeStamp=Date.now()}function f(a,e){var c=this._callbacks||(this._callbacks={}),b=a.type||String(a);return c[b]||e&&(c[b]=[])||[]}function p(a,e,c){var q=b.Promise||z,g=this;c=+c;var h=!c&&(b.setImmediate||E)||b.setTimeout||D;return new q(function(d,b){h(function(){try{d(a.apply(g,
e))}catch(m){b(m)}},c)})}u(k.prototype,{type:"*",toString:function(){return this.type}});u(b.prototype,{on:function(a,e){f.call(this,a,!0).push(e);return this},only:function(a,e){var c=f.call(this,a,!0);0>c.indexOf(e)&&c.push(e);return this},once:function(a,e){function c(){this.off(a,c);e.apply(this,arguments)}c.fn=e;return this.on(a,c)},off:function(a,e){var c=this._callbacks;if(!c)return this;if(0==arguments.length)return c&&(this._callbacks={}),this;var b=c[a];if(!b)return this;if(1==arguments.length)return delete c[a],
this;for(var g=b.length;g--;)c=b[g],c!==e&&c.fn!==e||C.call(b,g,1);return this},emit:function(a,b,c){var e=[],g=new k(a);g.result=e;var h;if(!(h=this._callbacks))return g;var d=h[g.type];h=h["*"];if(d&&d.length)d=h&&h.length?d.concat(h):r.call(d,0);else if(h&&h.length)d=r.call(h,0);else return g;h=r.call(arguments,0);h[0]=g;for(var l=0,m=d.length;l<m;++l){var f=d[l].apply(this,h);f!==x&&e.push(f)}return g},emitAfter:function(a,e,c,f){var g=b.Promise||z,h=[],d=+("number"==typeof a),l=new k(arguments[d]);
l.result=h;var m;if(!(m=this._callbacks))return g.resolve(l);var n=m[l.type];m=m["*"];if(n&&n.length)n=m&&m.length?n.concat(m):n;else if(m&&m.length)n=m;else return g.resolve(l);m=n.length;var q=r.call(arguments,d);q[0]=l;for(d?d=0:a=0;d<m;++d)h[d]=p.call(this,n[d],q,a);return g.all(h).then(function(a){l.result=a;return l})},emitAsync:function(a,e,c){var f=b.Promise||z,g=new k(a),h=[];g.result=h;var d;if(!(d=this._callbacks))return f.resolve(g);var l=d[g];d=d["*"];if(l&&l.length)l=d&&d.length?l.concat(d):
l;else if(d&&d.length)l=d;else return f.resolve(g);d=l.length;var m=r.call(arguments,0);m[0]=g;for(var n=0;n<d;++n)h[n]=p.call(this,l[n],m);return f.all(h).then(function(a){g.result=a;return g})},bind:function(a){var e=b.prototype,c;for(c in e)v.call(e,c)&&"function"==typeof e[c]&&(a[c]=y.call(e[c],this));return a},hasListeners:function(a){a=f.call(this,a,!1);return!(!a||!a.length)},hasListener:function(a,b){!b&&a&&(b=a,a="*");if("*"!=a){var c=f.call(this,a,!1);return!(!c||!~c.indexOf(b))}c=this._callbacks;
for(var e in c)if(v.call(c,e)&&-1<c[e].indexOf(b))return!0;return!1},listeners:f});b.Event=k;return b});"function"!=typeof y&&(y=function(b){var k=r.call(arguments,1),f=this,p=function(){},a=k.length?function(){var a=arguments;return f.apply(this instanceof p&&b?this:b,a.length?B(k,a):k)}:function(){return f.apply(this instanceof p&&b?this:b,arguments)};p.prototype=f.prototype;a.prototype=new p;return a})})("OnEmit","undefined"==typeof self?"undefined"==typeof global?this:global:self);
